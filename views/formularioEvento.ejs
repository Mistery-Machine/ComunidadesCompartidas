<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title><%= esEdicion ? 'Editar Evento' : 'Crear Evento' %></title>
    <link rel="stylesheet" href="/css/formulario-eventos.css"/>
</head>
<%- include("templates/navbar") %>
<body>
<div class="evento-formulario-contenedor">
    <h2 class="evento-titulo-formulario">
        <%= esEdicion ? 'Edición de Evento' : 'Creación de Eventos' %>
    </h2>

    <form method="POST" action="<%= esEdicion ? '/actualizar-evento/' + evento._id : '/crear-evento' %>" id="formulario-eventos">
        <!-- TÍTULO -->
        <div class="evento-grupo-formulario">
            <label class="evento-etiqueta-formulario" for="titulo">Título del Evento</label>
            <textarea class="evento-area-texto" id="titulo" name="titulo" placeholder="Ej: Festival Cultural 2025" required><%= esEdicion ? evento.titulo : '' %></textarea>
            <% if (!esEdicion) { %>
                <p class="formulario-input-error" id="error-titulo">El título debe tener entre 10 y 100 caracteres.</p>
            <% } %>
        </div>

        <!-- CATEGORÍA -->
        <div class="evento-grupo-formulario">
            <label class="evento-etiqueta-formulario" for="categoria">Categoría</label>
            <select class="evento-select-formulario" id="categoria" name="categoria" required>
                <option disabled <%= !esEdicion ? 'selected' : '' %>>Seleccione una categoría</option>
                <% for (let categoria of categorias) { %>
                    <option value="<%= categoria %>" <%= esEdicion && evento.categoria === categoria ? 'selected' : '' %>><%= categoria %></option>
                <% } %>
            </select>
            <% if (!esEdicion) { %>
                <p class="formulario-input-error" id="error-categoria">Es necesario seleccionar una categoría.</p>
            <% } %>
        </div>

        <!-- FECHA Y UBICACIÓN -->
        <div class="evento-fila-formulario">
            <div class="evento-columna-formulario">
                <label class="evento-etiqueta-formulario">Fecha de Generación</label>
                <input class="evento-campo-formulario" type="text" value="<%= esEdicion ? evento.fechaGeneracion : new Date().toLocaleDateString('es-ES') %>" disabled/>
            </div>
            <div class="evento-columna-formulario">
                <label class="evento-etiqueta-formulario" for="fechaEvento">Fecha del Evento</label>
                <input class="evento-campo-formulario" type="date" id="fechaEvento" name="fechaEvento" value="<%= esEdicion ? evento.fechaEvento : '' %>" required/>
                <% if (!esEdicion) { %>
                    <p class="formulario-input-error" id="error-fechaEvento">La fecha del evento es obligatoria.</p>
                <% } %>
            </div>
        </div>

        <!-- UBICACIÓN -->
        <div class="evento-grupo-formulario">
            <label class="evento-etiqueta-formulario" for="ubicacion">Ubicación</label>
            <input class="evento-campo-formulario" type="text" id="ubicacion" name="ubicacion" placeholder="Ciudad, provincia o lugar específico" value="<%= esEdicion ? evento.ubicacion : '' %>" required/>
            <% if (!esEdicion) { %>
                <p class="formulario-input-error" id="error-ubicacion">La ubicación debe tener entre 10 y 100 caracteres.</p>
            <% } %>
        </div>

        <!-- ORGANIZADOR -->
        <div class="evento-grupo-formulario">
            <label class="evento-etiqueta-formulario" for="organizador">Organizador</label>
            <input class="evento-campo-formulario" type="text" id="organizador" name="organizador" placeholder="Nombre del organizador" value="<%= esEdicion ? evento.organizador : '' %>" required/>
            <% if (!esEdicion) { %>
                <p class="formulario-input-error" id="error-organizador">El organizador debe tener entre 5 y 50 caracteres.</p>
            <% } %>
        </div>

        <!-- TELÉFONO -->
        <div class="evento-grupo-formulario">
            <label class="evento-etiqueta-formulario" for="telefono">Teléfono de Contacto</label>
            <input class="evento-campo-formulario" type="tel" id="telefono" name="telefono" placeholder="Ej: +506 8888-2234" value="<%= esEdicion ? evento.telefono : '' %>" required/>
            <% if (!esEdicion) { %>
                <p class="formulario-input-error" id="error-telefono">Formato de teléfono inválido.</p>
            <% } %>
        </div>

        <!-- BOTONES -->
        <div class="evento-grupo-formulario">
            <% if (esEdicion) { %>
                <button type="submit" class="evento-boton-enviar">Actualizar Evento</button>
                <a href="/listado-eventos" class="evento-boton-cancelar">Cancelar</a>
            <% } else { %>
                <button type="submit" class="evento-boton-enviar boton-deshabilitado" id="crear-evento" disabled>Crear Evento</button>
            <% } %>

            <p class="evento-texto-aviso">
                Al <%= esEdicion ? 'actualizar' : 'registrar' %> este evento, usted confirma que la información
                proporcionada es precisa y actualizada. </p>
        </div>
    </form>
</div>
<%- include("templates/footer") %>
<% if (!esEdicion) { %>
    <script src="/js/validacion-eventos.js"></script>
<% } %>
</body>
</html>